(this.webpackJsonpReactChat=this.webpackJsonpReactChat||[]).push([[0],{111:function(e,t,n){e.exports=n.p+"static/media/SpiralArrowDown.2d65758e.png"},114:function(e,t,n){e.exports=n.p+"static/media/comment.455a0a37.svg"},116:function(e,t,n){e.exports=n.p+"static/media/ChatBox.4d9f87f4.svg"},117:function(e,t,n){e.exports=n.p+"static/media/socketio.9c2629c4.png"},118:function(e,t,n){e.exports=n.p+"static/media/react.5d5d9eef.svg"},140:function(e,t,n){e.exports=n(210)},145:function(e,t,n){},146:function(e,t,n){},176:function(e,t){},179:function(e,t,n){},180:function(e,t,n){},184:function(e,t,n){},186:function(e,t,n){},187:function(e,t,n){},188:function(e,t,n){},189:function(e,t,n){},190:function(e,t,n){},191:function(e,t,n){e.exports=n.p+"static/media/socketio.5dc4ade3.svg"},210:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(13),c=n.n(o),i=(n(145),n(146),n(15)),s=n(8),l=n(9),u=n(11),d=n(10),m="https://ksk-react-chat-server.herokuapp.com",p=n(37),h=(n(62),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={},e.style={badge:{display:"inline-block",background:"#5e92b9",marginBottom:"0",textAlign:"center",fontWeight:"bold",color:"white",borderRadius:"15px",padding:"0px 8px",fontSize:"11px"}},e}return Object(l.a)(n,[{key:"render",value:function(){return 0===this.props.unread?"":this.props.unread>99?r.a.createElement("p",{style:this.style.badge},"99+"):r.a.createElement("p",{style:this.style.badge},this.props.unread)}}]),n}(a.Component)),g=n(7),f=n.n(g),v=n(43),y=n(49),b=n.n(y),x=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={socket:void 0},e}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement(E.Provider,{value:Object(v.a)({},this.state)},this.props.children)}},{key:"componentDidMount",value:function(){var e=this,t=b()("".concat(m));console.log("Connected to Socket"),t.on("start-establish",(function(){console.log("Server started establishment"),t.emit("establish",{token:f.a.get("token")},(function(n){1===n.statusCode?(console.log("Socket Established"),e.setState({socket:t})):n.cause}))}))}}]),n}(a.Component),E=Object(a.createContext)(),w=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={windowState:"none",currentFriend:void 0,currentChatId:void 0,currentConversation:[]},e.invokeConversation=function(t,n,a){e.setState({currentFriend:{uid:t,name:n},windowState:"loading"}),e.context.socket.emit("load-conversation",{token:f.a.get("token"),targetUid:t},(function(t){1===t.statusCode?e.setState({windowState:"active",currentConversation:t.conversation,currentChatId:a}):e.setState({windowState:"error",currentChatId:a})}))},e.addNewMsg=function(t){console.log("Adding new msg"),e.setState({currentConversation:[].concat(Object(p.a)(e.state.currentConversation),[t])})},e}return Object(l.a)(n,[{key:"render",value:function(){return r.a.createElement(C.Provider,{value:Object(v.a)(Object(v.a)({},this.state),{},{invokeConversation:this.invokeConversation,addNewMsg:this.addNewMsg})},this.props.children)}}]),n}(a.Component);w.contextType=E;var C=Object(a.createContext)(),k=(n(179),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={},e.formatDate=function(e){var t=new Date(e).toString().split(" "),n="".concat(parseInt(t[2])," ").concat(t[1]," ").concat(t[3]),a=new Date(e).toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0}),r=new Date(e).toLocaleDateString().split("/"),o=(new Date).toLocaleDateString().split("/");if(r[2]!==o[2]||r[1]!==o[1])return n;var c=Math.abs(parseInt(r[0])-parseInt(o[0]));return 0==c?a:1==c?"Yesterday":n},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=this.context.invokeConversation;return r.a.createElement("div",{ref:function(t){e.container=t},className:"container ".concat(!0===this.props.selected?"selected":"not-selected"),onClick:function(){e.container.style.opacity=.5,t(e.props.data.userDetails._id,e.props.data.userDetails.name,e.props.data._id)}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-sm-8 col-md-8 col-lg-8"},r.a.createElement("h6",{className:"user-full-name"},this.props.data.userDetails.name),void 0===this.props.data.content?r.a.createElement("p",{className:"no-preview"},r.a.createElement("span",null,"Say Hi to your friend")):r.a.createElement("p",{className:"preview"},r.a.createElement("span",null,this.props.data.trueSender===f.a.get("uid")?"You: ":""),this.props.data.content)),r.a.createElement("div",{className:"col-sm-4 col-md-4 col-lg-4",style:{padding:"0",textAlign:"end",paddingRight:"10px"}},r.a.createElement("h6",{style:{margin:"0 0 1px 0",fontSize:"12px",transition:"0.1s",opacity:!0===this.props.selected?"0":"1",color:"rgb(94, 146, 185)"}},this.formatDate(this.props.data.moment)),r.a.createElement(h,{unread:void 0===this.props.data.unread?0:this.props.data.unread}))))}}]),n}(a.Component));k.contextType=C;var S=k,O=n(234),j=(n(180),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={chats:void 0},e.shouldSelect=function(t){return e.conversationContext.currentChatId===t._id},e.renderChatList=function(t,n){return e.conversationContext=n,e.socketContext=t,void 0===e.state.chats||null===e.state.chats?r.a.createElement("div",{style:{marginTop:"50px",textAlign:"center"}}," ",r.a.createElement(O.a,null)," "):0===e.state.chats.length?r.a.createElement("div",{style:{marginTop:"50px",textAlign:"center"}}," ",r.a.createElement("p",{style:{fontSize:"12px",color:"#757575"}},"You don't have any chats.",r.a.createElement("br",null),"Add friends to chat with them.")," "):[].concat(e.state.chats).sort((function(e,t){return e.moment>t.moment?-1:1})).map((function(t,n){return r.a.createElement(S,{selected:e.shouldSelect(t),key:n,data:t})}))},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(E.Consumer,null,(function(t){return r.a.createElement(C.Consumer,null,(function(n){return r.a.createElement("div",{className:"customScroll",style:{height:"100%",overflowY:"scroll",paddingRight:"5px"}},e.renderChatList(t,n))}))}))}},{key:"componentDidMount",value:function(){var e=this;this.socketContext.socket.emit("get-all-chats",{token:f.a.get("token")},(function(t){console.log("all-chats from server: ",t),1===t.statusCode&&e.setState({chats:t.chats})})),this.socketContext.socket.on("new-chat",(function(t){console.log("Adding new chat to list: ",t),e.setState({chats:[t].concat(Object(p.a)(e.state.chats))})})),this.socketContext.socket.on("chat-update",(function(t){console.log("Chat Update: ",t);var n=e.state.chats.findIndex((function(e){return e._id===t.update._id}));if(-1!==n){var a=e.state.chats[n];a.type=t.update.type,a.trueSender=t.update.trueSender,a.moment=t.update.moment,a.content=t.update.content,a.unread=t.update.unread,e.setState({chats:e.state.chats})}}))}}]),n}(a.Component));j.contextType=E;var T=j,N=(n(184),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={},e.logout=function(){f.a.remove("token"),f.a.remove("username"),e.props.history.push("/"),e.context.socket.disconnect()},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"primary"},r.a.createElement("h4",{className:"name"},f.a.get("name")),r.a.createElement("h5",{className:"username"},r.a.createElement("span",null,"Username: "),f.a.get("username")),r.a.createElement("p",{className:"logout",onClick:function(){e.logout()}},"Logout"))}}]),n}(a.Component));N.contextType=E;var D=N,I=n(119),R=n.n(I),A=n(120),B=n.n(A),M=(n(97),n(52)),U=n(109),q=n.n(U),F=n(110),L=n.n(F),W=n(238),P=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(e){var a;Object(s.a)(this,n),(a=t.call(this,e)).formatDate=function(e){var t=(new Date).toString().split(" ");if(e[2]!==t[2]||e[1]!==t[1])return"".concat(parseInt(e[2])," ").concat(e[1]," ").concat(e[3]);var n=Math.abs(parseInt(e[2])-parseInt(t[2]));return 0==n?"Today":1==n?"Yesterday":n<365?"".concat(parseInt(e[2])," ").concat(e[1]):"".concat(parseInt(e[2])," ").concat(e[1]," ").concat(e[3])},a.state={},a.style={body:{background:"#fefefe",borderRadius:"5px",borderColor:"#eaeaea",borderStyle:"solid",borderWidth:"2px",padding:"10px 10px 5px 15px",marginBottom:"10px"}};var r=a.props.data.moment;a.timeStr=new Date(Number(r)).toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});var o=new Date(parseInt(a.props.data.moment)).toString().split(" ");return a.dateStr=a.formatDate(o),a}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:this.style.body},r.a.createElement("h6",{style:{marginBottom:"5px",fontWeight:"bold",wordBreak:"break-all",fontSize:"16px"}},this.props.data.userDetails.name),r.a.createElement("p",{style:{fontWeight:"normal",margin:"0",width:"100%",textAlign:"left",fontSize:"12px",color:"#757575"}},"".concat(this.dateStr," ").concat(this.timeStr)),r.a.createElement("div",{style:{textAlign:"right",marginTop:"10px"}},r.a.createElement(W.a,{onClick:function(){e.context.socket.emit("reject-friend-request",{token:f.a.get("token"),friendRequestId:e.props.data._id},(function(t){1===t.statusCode?e.props.removeCallback(e.props.data._id):window.alert("Error Occurred!")}))},style:{marginRight:"10px",padding:"0",outline:"none",border:"none"}},r.a.createElement(q.a,{color:"secondary"})),r.a.createElement(W.a,{style:{padding:"1px 2px",borderRadius:"20px",background:"#08c55b",outline:"none",border:"none"},onClick:function(){e.context.socket.emit("accept-friend-request",{token:f.a.get("token"),friendRequestId:e.props.data._id},(function(t){1===t.statusCode?e.props.removeCallback(e.props.data._id):window.alert("Error Occurred!")}))}},r.a.createElement(L.a,{style:{padding:"2px 0px",color:"white",marginLeft:"3px"}}),r.a.createElement("h6",{style:{fontSize:"13px",fontWeight:"bold",marginBottom:"0",marginTop:"1px",marginRight:"10px",color:"white",marginLeft:"5px",textTransform:"uppercase"}},"Accept"))))}}]),n}(a.Component);P.contextType=E;var z=P,Y=n(245),_=(n(186),n(112)),H=n.n(_),K=n(244),J=n(247),G=n(249),Q=n(243),X=n(241),$=n(242),V=n(240),Z=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={open:!1,progress:!1},e.openDialog=function(){e.setState({open:!0})},e.closeDialog=function(){e.setState({open:!1})},e.sendRequest=function(t){e.setState({progress:!0}),e.context.socket.emit("publish-friend-request",{token:f.a.get("token"),receiverUsername:t},(function(t){console.log(t),e.setState({progress:!1}),1===t.statusCode?(e.closeDialog(),window.alert("Request Sent")):window.alert(t.msg)}))},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(G.a,{open:this.state.open,onClose:function(){e.closeDialog()},"aria-labelledby":"form-dialog-title",disableBackdropClick:!0},r.a.createElement(V.a,{id:"form-dialog-title"},"Send Friend Request"),r.a.createElement(X.a,null,r.a.createElement($.a,null,"You'll be able to chat only when a person has accepted your friendship request."),r.a.createElement(J.a,{autoFocus:!0,margin:"dense",id:"usernameText",label:"Recepient Username",type:"text",fullWidth:!0})),r.a.createElement(Q.a,{style:{marginRight:"10px",marginBottom:"5px"}},this.state.progress?r.a.createElement(O.a,null):r.a.createElement(r.a.Fragment,null,r.a.createElement(K.a,{onClick:function(){e.closeDialog()},color:"primary"},"Cancel"),r.a.createElement(K.a,{onClick:function(){e.sendRequest(document.getElementById("usernameText").value)},color:"primary"},"Send")))))}}]),n}(a.Component);Z.contextType=E;var ee=n(111),te=n.n(ee),ne=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={friendRequests:void 0},e.removeFR=function(t){var n=e.state.friendRequests.filter((function(e){return e._id!==t}));console.log(n),e.setState({friendRequests:n})},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{position:"relative",height:"100%",overflowY:"hidden"}},r.a.createElement("div",{className:"customScroll",style:{height:"100%",overflowY:"scroll",paddingRight:"5px",paddingBottom:"80px"}},void 0===this.state.friendRequests?r.a.createElement("div",{style:{width:"100%",textAlign:"center",marginTop:"100px"}},r.a.createElement(O.a,null)):0===this.state.friendRequests.length?r.a.createElement("p",{style:{color:"#6c757d",opacity:"1",marginTop:"10px",width:"100%",textAlign:"center",fontSize:"12px",fontFamily:"Montserrat"}},"You have no new ",r.a.createElement("b",null,"Friend Requests"),r.a.createElement("br",null),"Click here to send one",r.a.createElement("img",Object(M.a)({src:te.a,style:{marginTop:"25px"}},"style",{height:"40%",width:"70%",opacity:"0.1",marginTop:"30px",transform:"rotate(10DEG) translateX(10px)"}))):this.state.friendRequests.map((function(t,n){return r.a.createElement(z,{key:t._id,data:t,removeCallback:e.removeFR})}))),r.a.createElement(Y.a,{onClick:function(){e.reqDialog.openDialog()},variant:"extended",size:"small",color:"secondary",style:{position:"absolute",bottom:"15px",right:"15px",outline:"none",border:"none",fontSize:"14px",paddingRight:"15px",paddingLeft:"15px",textTransform:"none",fontFamily:"Quicksand",fontWeight:"bold"}}," ",r.a.createElement(H.a,{style:{fontSize:"20px",marginRight:"5px"}})," New Request "),r.a.createElement(Z,{ref:function(t){e.reqDialog=t}}))}},{key:"componentDidMount",value:function(){var e=this;this.context.socket.emit("get-friend-requests",{token:f.a.get("token")},(function(t){console.log("all-FRs: ",t),e.setState({friendRequests:t})})),this.context.socket.on("new-friend-request",(function(t){console.log("New FR: ",t),e.setState({friendRequests:[t].concat(Object(p.a)(e.state.friendRequests))})}))}}]),n}(a.Component);ne.contextType=E;var ae=ne,re=n(113),oe=n.n(re),ce=(n(187),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={visibility:0},e.sendMsg=function(){var t=e.textInput.value;0!==t.length&&(e.textInput.disabled=!0,e.setState({visibility:2}),e.context.socket.emit("send-msg",{token:f.a.get("token"),targetUid:e.props.targetUid,content:t,type:"text"},(function(t){e.setState({visibility:0}),e.textInput.disabled=!1,0===t.statusCode?window.alert("Error Occured"):(document.getElementById("text").value="",document.getElementById("text").focus())})))},e.renderSend=function(){switch(e.state.visibility){case 1:return r.a.createElement(W.a,{className:"sendButton",onClick:function(){e.sendMsg()},"aria-label":"delete"},r.a.createElement(oe.a,null));case 2:return r.a.createElement(O.a,{className:"progress"});default:return""}},e.handleChange=function(t){e.setState({visibility:e.textInput.value.length>0?1:0})},e.handleKeyDown=function(t){"Enter"===t.key&&t.shiftKey?(e.textInput.value+="\n",e.textInput.scrollTop=e.textInput.scrollHeight,t.preventDefault()):"Enter"===t.key&&(e.sendMsg(),t.preventDefault())},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{style:{width:"100%",height:"10%",position:"absolute",bottom:"0",display:"table",background:"aliceblue"}},r.a.createElement("div",{style:{height:"2.5rem",background:"white",display:"table-cell",verticalAlign:"middle",borderRadius:"10px",borderStyle:"solid",borderColor:"#32708e96",position:"relative"}},r.a.createElement("textarea",{ref:function(t){e.textInput=t},onKeyDown:function(t){e.handleKeyDown(t)},onChange:function(t){e.handleChange(t)},id:"text",placeholder:"Write message here ...",maxLength:1e3}),this.renderSend()))}}]),n}(a.Component));ce.contextType=E;var ie=ce,se=(n(188),function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={expanded:!1},e.renderMsg=function(t){return!0===e.state.expanded?e.props.msg.content:e.props.msg.content.length>t?[e.props.msg.content.substring(0,50),"...",r.a.createElement("span",{key:"none",onClick:function(){e.setState({expanded:!0})},className:"more"},"Show More")]:e.props.msg.content},e.formatDateHead=function(e,t){var n=new Date(t).toLocaleDateString().split("/"),a=(new Date).toLocaleDateString().split("/");if(n[2]!==a[2]||n[1]!==a[1])return e;var r=Math.abs(parseInt(n[0])-parseInt(a[0]));return 0==r?"Today":1==r?"Yesterday":e},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this,t=parseInt(String(this.props.msg.moment).substring(0,13)),n=new Date(t).toString().split(" "),a=parseInt(String(this.props.lastMoment).substring(0,13)),o=new Date(a).toString().split(" "),c="".concat(parseInt(n[2])," ").concat(n[1]," ").concat(n[3]),i="".concat(parseInt(o[2])," ").concat(o[1]," ").concat(o[3]),s=new Date(t).toLocaleString("en-US",{hour:"numeric",minute:"numeric",hour12:!0});return r.a.createElement(r.a.Fragment,null,c!==i?r.a.createElement("div",{className:"dateContainer"},r.a.createElement("p",{className:"dateText"},this.formatDateHead(c,t))):"",r.a.createElement("div",{ref:function(t){e.element=t},className:"msg ".concat(this.props.msg.senderUid===f.a.get("uid")?"myMsg":"notMyMsg")},r.a.createElement("div",{className:"msgPrimary ".concat(!0===this.props.reduceMargin?"noMargin":"")},r.a.createElement("p",{className:"msgContent"},this.renderMsg(50)),r.a.createElement("p",{className:"timeText"},s))))}},{key:"componentDidUpdate",value:function(){!0===this.state.expanded&&this.props.onExpanded(this.element.offsetTop)}}]),n}(a.Component)),le=(n(189),n(115)),ue=n.n(le),de=n(246),me=n(114),pe=n.n(me),he=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={scrolledUp:!1,unread:0},e.vars={lastScrollTop:0},e.style={container:{height:"82%",overflowY:"scroll",position:"absolute",bottom:"10%",width:"100%",marginBottom:"0",paddingLeft:"0"}},e.scrollToBottom=function(){"visible"!==e.fab.style.visibility&&(e.listElement.scrollTop=e.listElement.scrollHeight)},e.scrollToExpanded=function(e){console.log("Scrolling to: ",e),document.getElementById("list").scrollTop=e},e.handleScroll=function(){var t=e.listElement.scrollTop,n=e.listElement.scrollHeight,a=e.listElement.offsetHeight;t>e.vars.lastScrollTop?"visible"===e.fab.style.visibility&&t>n-a-100&&(e.fab.style.visibility="hidden"):"hidden"===e.fab.style.visibility&&t<n-a-100&&(e.fab.style.visibility="visible"),e.vars.lastScrollTop=t<=0?0:t},e.renderItems=function(){return 0===e.conversationContext.currentConversation.length?r.a.createElement("div",{className:"container-fluid placeholder",style:{marginTop:"25%",textAlign:"center"}},r.a.createElement("img",{src:pe.a,width:"110px",height:"110px"}),r.a.createElement("h6",null,"Either of you haven't started talking yet.",r.a.createElement("br",null),"Send a message now."),r.a.createElement("p",{className:"first"},"Press ",r.a.createElement("span",null,"Ctrl + Enter")," for newline"),r.a.createElement("p",null,"Press ",r.a.createElement("span",null,"Enter")," to send the message")):e.conversationContext.currentConversation.map((function(t,n){return r.a.createElement(se,{reduceMargin:0!==n&&e.conversationContext.currentConversation[n-1].senderUid===e.conversationContext.currentConversation[n].senderUid,onExpanded:e.scrollToExpanded,lastMoment:0==n?void 0:e.conversationContext.currentConversation[n-1].moment,key:t._id,msg:t})}))},e.renderByContext=function(t,n){return e.socketContext=t,e.conversationContext=n,r.a.createElement("div",{ref:function(t){e.listElement=t},onScroll:function(){e.handleScroll()},id:"list",className:"custom-scroll",style:e.style.container},e.renderItems(),r.a.createElement(de.a,{ref:function(t){e.fab=t},badgeContent:e.state.unread,color:"secondary",style:{position:"sticky",bottom:"5%",left:"86%",visibility:"hidden"}},r.a.createElement(Y.a,{onClick:function(){e.setState({unread:0}),e.listElement.scrollTop=e.listElement.scrollHeight},size:"small",style:{background:"#039be5",fontSize:"14px",outline:"none",border:"none",marginLeft:"20px"}}," ",r.a.createElement(ue.a,{style:{color:"white"}})," ")))},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(E.Consumer,null,(function(t){return r.a.createElement(C.Consumer,null,(function(n){return e.renderByContext(t,n)}))}))}},{key:"componentDidMount",value:function(){var e=this;this.socketContext.socket.on("new-msg",(function(t){console.log("new msg: ",t);var n=t.msg;n.senderUid===f.a.get("uid")?(console.log("I'm sender Comparing: ",e.conversationContext.currentFriend.uid,n.receiverUid),e.conversationContext.currentFriend.uid===n.receiverUid&&e.conversationContext.addNewMsg(n)):(console.log("I'm receiver Comparing: ",e.conversationContext.currentFriend.uid,n.senderUid,e.conversationContext.currentFriend.uid===n.senderUid),e.conversationContext.currentFriend.uid===n.senderUid&&(console.log("Firing..."),e.conversationContext.addNewMsg(n)))})),this.scrollToBottom()}},{key:"componentDidUpdate",value:function(){this.scrollToBottom()}},{key:"componentWillUnmount",value:function(){this.socketContext.socket.off("new-msg")}}]),n}(a.Component),ge=n(116),fe=n.n(ge),ve=(n(190),n(58)),ye=n.n(ve),be=n(70),xe=n.n(be),Ee=n(59),we=n.n(Ee),Ce=n(117),ke=n.n(Ce),Se=n(118),Oe=n.n(Se),je=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,o=new Array(a),c=0;c<a;c++)o[c]=arguments[c];return(e=t.call.apply(t,[this].concat(o))).state={},e.renderByContext=function(e,t){switch(t.windowState){case"loading":return r.a.createElement("div",{className:"container-fluid",style:{textAlign:"center",marginTop:"45vh"}},r.a.createElement(O.a,null),r.a.createElement("p",null,"Loading Conversation"));case"active":return r.a.createElement(r.a.Fragment,null,r.a.createElement(he,null),r.a.createElement(ie,{targetUid:t.currentFriend.uid}));case"error":return r.a.createElement("div",{className:"container-fluid no-msg-container"},r.a.createElement("p",{style:{opacity:"0.6"}},"Error while loading conversation"));default:return r.a.createElement("div",{className:"container-fluid no-msg-container"},r.a.createElement("img",{src:fe.a,height:"128px",width:"128px"}),r.a.createElement("p",{style:{opacity:"0.6"}},"Select a chat to start conversation"))}},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(E.Consumer,null,(function(t){return r.a.createElement(C.Consumer,null,(function(n){return r.a.createElement("div",null,r.a.createElement("div",{style:{height:"5%",width:"100%",overflow:"hidden"}},r.a.createElement("p",{style:{textAlign:"center",fontFamily:"Montserrat",fontSize:"12px",color:"#bdbdbd"}},"Built with Love using",r.a.createElement("img",{src:Oe.a,width:"32px",height:"32px"}),r.a.createElement("img",{style:{marginLeft:"5px"},src:we.a,width:"24px",height:"24px"}),r.a.createElement("img",{style:{marginLeft:"5px"},src:ye.a,width:"24px",height:"24px"}),r.a.createElement("img",{style:{marginLeft:"5px",marginRight:"10px"},src:ke.a,width:"22px",height:"22px"}),"On",r.a.createElement("img",{style:{marginLeft:"5px"},src:xe.a,width:"20px",height:"20px"}))),e.renderByContext(t,n))}))}))}},{key:"componentDidMount",value:function(){}}]),n}(a.Component),Te=(n(191),a.Component,function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={selectedTab:"chat"},e.selectTab=function(t,n){if(n!==e.state.selectedTab){var a=document.querySelectorAll(".tabButton");[].forEach.call(a,(function(e){e.classList.remove("tabSelected")})),t.classList.add("tabSelected"),e.setState({selectedTab:n})}},e}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return void 0===this.context.socket?r.a.createElement("div",{className:"container-fluid progressContainer"},r.a.createElement(O.a,null)):r.a.createElement("div",{className:"container mainContainer"},r.a.createElement("div",{className:"container-fluid primaryContainer"},r.a.createElement("div",{className:"row primaryRow"},r.a.createElement("div",{className:"col-lg-8 chatWindowContainer"},r.a.createElement(je,null)),r.a.createElement("div",{className:"col-lg-4",id:"panel-window"},r.a.createElement("div",{className:"panelWindowContainer"},r.a.createElement("div",{className:"header"},r.a.createElement(D,{history:this.props.history}),r.a.createElement("div",{className:"tabs"},r.a.createElement("button",{className:"tabButton tabSelected",onClick:function(t){e.selectTab(t.currentTarget,"chat")}},r.a.createElement("span",null," ",r.a.createElement(R.a,null)," ")),r.a.createElement("button",{className:"tabButton",onClick:function(t){e.selectTab(t.currentTarget,"friend-request")},style:{marginLeft:"10px"}},r.a.createElement("span",null," ",r.a.createElement(de.a,{badgeContent:void 0===this.state.friendRequests?0:this.state.friendRequests.length,color:"secondary"}," ",r.a.createElement(B.a,null)," ")," ")))),r.a.createElement("div",{className:"listContainer"},r.a.createElement("div",{className:"listContainerPrimary ".concat("chat"===this.state.selectedTab?"shown":"hidden")},r.a.createElement(T,{className:"chatlist",current:this.state.currentFriend,chatClickCallback:this.onChatClick,history:this.props.history,socket:this.context.socket,chats:this.state.chats,handleIncomingChat:this.incomingChatCallback})),r.a.createElement("div",{className:"listContainerPrimary ".concat("friend-request"===this.state.selectedTab?"shown":"hidden")},r.a.createElement(ae,null))))))))}}]),n}(a.Component));Te.contextType=E;var Ne=Te,De=n(123),Ie=function(e){var t=e.component,n=Object(De.a)(e,["component"]);return r.a.createElement(i.b,Object.assign({},n,{render:function(e){return f.a.get("token")?r.a.createElement(x,null,r.a.createElement(w,null,r.a.createElement(t,e))):r.a.createElement(i.a,{to:{pathname:"/land"}})}}))},Re=n(73),Ae=n.n(Re),Be=n(121),Me=n(122),Ue=n(100).default;function qe(e){var t=r.a.useState(!1),n=Object(Me.a)(t,2),a=n[0],o=n[1],c=function(){o(!1)};return e.callback((function(){o(!0)})),r.a.createElement("div",null,r.a.createElement(G.a,{open:a,onClose:c,"aria-labelledby":"form-dialog-title"},r.a.createElement(V.a,{id:"form-dialog-title"},"Subscribe"),r.a.createElement(X.a,null,r.a.createElement($.a,null,"To subscribe to this website, please enter your email address here. We will send updates occasionally."),r.a.createElement(J.a,{autoFocus:!0,margin:"dense",id:"regNameText",label:"Full Name",type:"text",fullWidth:!0}),r.a.createElement(J.a,{autoFocus:!0,margin:"dense",id:"regUsernameText",label:"Username",type:"text",fullWidth:!0}),r.a.createElement(J.a,{autoFocus:!0,margin:"dense",id:"regPasswordText",label:"Password",type:"password",fullWidth:!0})),r.a.createElement(Q.a,null,r.a.createElement(K.a,{onClick:function(){var e,t,n;e=document.getElementById("regNameText").value,t=document.getElementById("regUsernameText").value,n=document.getElementById("regPasswordText").value,Ue.post("".concat(m,"/register"),{name:e,username:t,password:n}).then((function(e){1===e.data.statusCode?(window.alert("You're Signed Up"),c()):window.alert("Error Occured")})).catch((function(e){console.log(e)}))},color:"primary"},"Sign Up"))))}var Fe=n(100).default,Le=function(e){Object(u.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(s.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={handleRegOpen:void 0},e.regOpenCallback=function(t){e.handleRegOpen=t},e.mockLogin=function(){f.a.set("token","awesome",{expires:86400,path:"/"}),f.a.set("username",document.getElementById("usernameText").value,{expires:86400,path:"/"}),e.props.history.push("/")},e.login=function(e,t){return new Promise((function(n,a){Fe.post("".concat(m,"/login"),{username:e,password:t}).then((function(e){console.log(e.data),1===e.data.statusCode?n(e.data):a("Incorrect Username or Password")})).catch((function(e){console.log(e),a("Error Occured")}))}))},e.loginPromise=function(){var t=Object(Be.a)(Ae.a.mark((function t(n,a){var r;return Ae.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.login(n,a);case 3:r=t.sent,f.a.set("uid",r.uid,{expires:86400,path:"/"}),f.a.set("token",r.token,{expires:86400,path:"/"}),f.a.set("name",r.name,{expires:86400,path:"/"}),f.a.set("username",r.username,{expires:86400,path:"/"}),e.props.history.push("/"),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),window.alert(t.t0);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})));return function(e,n){return t.apply(this,arguments)}}(),e}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"conatiner"},r.a.createElement("div",{className:"container-fluid",style:{textAlign:"center",marginTop:"20vh"}},r.a.createElement("h1",null,"Chat App"),r.a.createElement("div",null,r.a.createElement("div",null,r.a.createElement("input",{id:"usernameText",type:"text",placeholder:"Username"})),r.a.createElement("div",{style:{margin:"10px"}},r.a.createElement("input",{id:"passwordText",type:"text",placeholder:"Password"})),r.a.createElement("button",{className:"btn btn-outline-success",onClick:function(){e.loginPromise(document.getElementById("usernameText").value,document.getElementById("passwordText").value)}},"Login"),r.a.createElement("p",{style:{marginTop:"20px"}},"Not a user? ",r.a.createElement("a",{href:"#",onClick:this.state.handleRegOpen,"data-toggle":"modal","data-target":"#exampleModalCenter"},"Register")," Now"))),r.a.createElement(qe,{callback:this.regOpenCallback}))}},{key:"componentDidMount",value:function(){this.setState({handleRegOpen:this.handleRegOpen})}}]),n}(a.Component);var We=function(){return r.a.createElement(i.d,null,r.a.createElement(i.b,{exact:!0,path:"/land",component:Le}),r.a.createElement(Ie,{exact:!0,path:"/",component:Ne}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Pe=n(50);c.a.render(r.a.createElement(Pe.a,null,r.a.createElement(We,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},58:function(e,t,n){e.exports=n.p+"static/media/mongodb.4fe5b11d.png"},59:function(e,t,n){e.exports=n.p+"static/media/nodejs.c502658a.png"},70:function(e,t,n){e.exports=n.p+"static/media/heroku.7df930e9.svg"},97:function(e,t,n){}},[[140,1,2]]]);
//# sourceMappingURL=main.3dff670d.chunk.js.map